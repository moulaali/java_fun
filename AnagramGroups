import com.google.common.collect.ArrayListMultimap;
import com.google.common.collect.Multimap;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collection;
import java.util.List;
import java.util.Map.Entry;

/**
 * Groups a {@link List} of {@link String}s to anagrams.
 */
public class AnagramGroups {

  public static void main(String[] args) {
    List<String> inputStrings = new ArrayList<>();
    inputStrings.add("foo");
    inputStrings.add("bar");
    inputStrings.add("blah");
    inputStrings.add("oof");
    inputStrings.add("halb");
    inputStrings.add("rab");
    // Prints [[bar, rab], [foo, oof], [blah, halb]]
    System.out.println(getAnagramGroups(inputStrings));
  }

  private static List<List<String>> getAnagramGroups(List<String> inputStrings) {
    Multimap<String, String> anagramGroupsMap = ArrayListMultimap.create();
    List<List<String>> groups = new ArrayList<>();

    for (String input : inputStrings) {
      char[] chars = input.toCharArray();
      Arrays.sort(chars);
      anagramGroupsMap.put(new String(chars), input);
    }
    for (Entry<String, Collection<String>> entry : anagramGroupsMap.asMap().entrySet()) {
      groups.add((List<String>) entry.getValue());
    }
    return groups;
  }
}
